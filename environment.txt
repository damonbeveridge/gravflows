# Environment Setup

## This file outlines commands used to create
## the conda virtual environment used (as of 09/07/21)
## Our machine was Ubuntu 18.04 LTS with NVIDIA CUDA 11.2

# conda environments
conda create -n <name> python=3.8
conda activate <name>
conda install pip  # check latest version

## we install with pip moving forward
## we recommend installing all conda packages
## before using any pip install command

# astro packages
## astropy < 4.2.1 and pycbc 1.18.1 had a (temp) incompatibility(?)
## we know astropy==4.2.1 works without issue
## so we download pycbc==1.18.0 (implicitly)
## pycbc 1.18.0 requires numpy!=1.19.0,<1.20.0,>=1.16.0; python_version >= "3.5"
## handling these dependencies may not be required with future versions of astropy/pycbc
## technically, we can just specify the version of pycbc==1.18.0 and pip should resolve it
pip install pycbc==1.18.0 numpy astropy lalsuite bilby gwpy ligo.skymap

# pytorch / normalizing flows
## ChainConsumer for https://github.com/stephengreen/lfi-gw
pip install torch==1.9.0+cu111 torchvision==0.10.0+cu111 torchaudio==0.9.0 -f https://download.pytorch.org/whl/torch_stable.html
pip install pytorch-lightning
pip install nflows ChainConsumer

# miscellaneous (may not need jupyterlab stuff)
pip install ipython jupyterlab scikit-learn corner plotly

# SotA distributed training
pip install deepspeed

# concurrent multitasking (optional))
pip install aiohttp aiofiles

# pyro (optional)
# pip install pyro-ppl